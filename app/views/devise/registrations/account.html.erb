<div class="profile-title-wrapper">
  <h2 class="profile-title">アカウント設定</h2>
</div>

<%= form_for(current_user, url: user_account_path, html: { method: :put, class: "profile-form-container" }) do |f| %>
  <%= hidden_field_tag :form_type, "profile" %>

  <!-- アバター -->
  <div class="profile-avatar-wrapper">
    <%= f.file_field :avatar, id: "avatar_input", class: "profile-avatar-input" %>
    <label for="avatar_input" class="profile-avatar-label">
      <% if resource.avatar.attached? %>
        <%= image_tag resource.avatar.variant(resize_to_limit: [120, 120]), class: "profile-avatar-img" %>
      <% else %>
        <svg class="bg-gray-200 rounded-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="gray" width="120" height="120">
          <circle cx="12" cy="8" r="4"/>
          <path d="M12 14c-4 0-6 2-6 4v2h12v-2c0-2-2-4-6-4z"/>
        </svg>
      <% end %>
      <i class="fa fa-camera profile-avatar-camera"></i>
    </label>
  </div>

  <!-- 名前 -->
  <div class="profile-form-group">
    <%= f.label :name, "名前", class: "profile-form-label" %>
    <%= f.text_field :name, value: resource.name.presence || "", class: "form-input #{'input-error' if resource.errors[:name].any?}" %>
    <% if resource.errors[:name].any? %>
      <p class="error-message"><%= "名前#{resource.errors[:name].first}" %></p>
    <% end %>
  </div>

  <!-- メール -->
  <div class="profile-form-group">
    <%= f.label :email, "メールアドレス", class: "profile-form-label" %>
    <%= f.email_field :email, value: resource.email.presence || "", class: "form-input #{'input-error' if resource.errors[:email].any?}" %>
    <% if resource.errors[:email].any? %>
      <p class="error-message"><%= "メールアドレス#{resource.errors[:email].first}" %></p>
    <% end %>
  </div>

  <div class="profile-form-actions">
    <%= f.submit "更新する", class: "profile-form-btn" %>
  </div>
<% end %>

<div class="profile-divider-wrapper">
  <span class="profile-divider-text">または</span>
</div>

<div class="profile-form-actions profile-form-actions-inline" style="margin-top: 1rem;">
  <%= link_to "パスワード変更", edit_user_registration_path, class: "profile-form-btn" %>
  <button type="button" class="profile-form-btn profile-form-btn-danger" id="deleteAccountBtn">退会のお手続き</button>
</div>

<!-- 削除警告モーダル -->
<div id="deleteAccountModal" class="profile-destroy-modal hidden">
  <div class="profile-destroy-inner">
    <h3 class="profile-destroy-title">退会のお手続き</h3>
    <p class="profile-destroy-text">
      アカウントを削除すると、これまでのデータは全て削除され、復元できなくなります。<br>
      この操作は取り消せません。本当にアカウントを削除してもよろしいですか？
    </p>
    <div class="profile-destroy-actions">
      <%= button_to "アカウント削除", registration_path(resource_name), method: :delete, class: "profile-form-btn profile-form-btn-danger" %>
      <button type="button" class="profile-form-btn" id="cancelDeleteBtn">キャンセルする</button>
    </div>
  </div>
</div>