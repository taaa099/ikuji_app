<tr id="dashboard_record_<%= record.id %>">
  <!-- 日時 -->
  <td class="dashboard-col-date">
    <% date_columns = {
      "Feed" => :fed_at,
      "Diaper" => :changed_at,
      "Bottle" => :given_at,
      "Hydration" => :fed_at,
      "BabyFood" => :fed_at,
      "SleepRecord" => :start_time,
      "Temperature" => :measured_at,
      "Bath" => :bathed_at,
      "Vaccination" => :vaccinated_at
    } %>
    <% datetime = record.send(date_columns[record.class.name]) rescue nil %>
    <span class="font-semibold text-gray-600">時間：</span>
    <%= datetime ? datetime.strftime("%H:%M") : "時間なし" %>
  </td>

  <!-- アイコン＋テキスト -->
  <td class="dashboard-col-item">
    <% icon_classes = {
      "Feed" => ["fa-person-breastfeeding", "text-pink-500", "授乳"],
      "Diaper" => ["fa-baby", "text-yellow-400", "おむつ"],
      "Bottle" => ["fa-bottle-droplet", "text-blue-400", "ミルク"],
      "Hydration" => ["fa-bottle-water", "text-sky-400", "水分補給"],
      "BabyFood" => ["fa-utensils", "text-orange-400", "離乳食"],
      "SleepRecord" => ["fa-moon", "text-purple-500", "睡眠"],
      "Bath" => ["fa-bath", "text-sky-400", "お風呂"],
      "Temperature" => ["fa-temperature-three-quarters", "text-red-500", "体温"],
      "Vaccination" => ["fa-syringe", "text-green-500", "予防接種"]
    } %>
    <% icon, color, label = icon_classes[record.class.name] %>
    <div class="flex items-center gap-2">
      <i class="fa-solid <%= icon %> <%= color %>" style="font-size:20px;"></i>
      <span class="text-gray-600 font-semibold text-sm"><%= label %></span>
    </div>
  </td>

  <!-- 内容 -->
  <% case record.class.name %>
    <% when "Feed" %>
      <td class="dashboard-col-detail">
        <% left_min = record.left_time / 60 %>
        <% left_sec = record.left_time % 60 %>
        <span class="font-semibold text-gray-600">左：</span>
        <%= "#{left_min}分#{left_sec}秒" %>
      </td>
      <td class="dashboard-col-detail">
        <% right_min = record.right_time / 60 %>
        <% right_sec = record.right_time % 60 %>
        <span class="font-semibold text-gray-600">右：</span>
        <%= "#{right_min}分#{right_sec}秒" %>
      </td>
      <td class="dashboard-col-memo">
      <% if record.memo.present? %>
        <span class="font-semibold text-gray-600">メモ：</span>
        <%= truncate(record.memo.to_s, length: 10, omission: "…") %></td>
      <% end %>

    <% when "Diaper" %>
      <td class="dashboard-col-detail">
        <% if record.pee? && record.poop? %>
          おしっこ＋うんち
        <% elsif record.pee? %>
          おしっこ
        <% elsif record.poop? %>
          うんち
        <% else %>
          なし
        <% end %>
      </td>
      <td class="dashboard-col-detail"></td>
      <td class="dashboard-col-memo">
      <% if record.memo.present? %>
        <span class="font-semibold text-gray-600">メモ：</span>
        <%= truncate(record.memo.to_s, length: 10, omission: "…") %></td>
      <% end %>

    <% when "Bottle" %>
      <td class="dashboard-col-detail">
       <span class="font-semibold text-gray-600">量 (ml)：</span>
      <%= record.amount %>ml</td>
      <td class="dashboard-col-detail"></td>
      <td class="dashboard-col-memo">
      <% if record.memo.present? %>
        <span class="font-semibold text-gray-600">メモ：</span>
        <%= truncate(record.memo.to_s, length: 10, omission: "…") %></td>
      <% end %>

    <% when "Hydration" %>
      <td class="dashboard-col-detail">
      <span class="font-semibold text-gray-600">種類：</span>
      <%= record.drink_type %></td>
      <td class="dashboard-col-detail">
      <% if record.amount.present? %>
        <span class="font-semibold text-gray-600">量 (ml)：</span>
        <%= record.amount %>ml</td>
      <% end %>
      <td class="dashboard-col-memo">
      <% if record.memo.present? %>
        <span class="font-semibold text-gray-600">メモ：</span>
        <%= truncate(record.memo.to_s, length: 10, omission: "…") %></td>
      <% end %>

    <% when "BabyFood" %>
      <td class="dashboard-col-detail">
      <span class="font-semibold text-gray-600">量 (ml)：</span>
      <%= record.amount %>ml</td>
      <td class="dashboard-col-detail"></td>
      <td class="dashboard-col-memo">
      <% if record.memo.present? %>
        <span class="font-semibold text-gray-600">メモ：</span>
        <%= truncate(record.memo.to_s, length: 10, omission: "…") %></td>
      <% end %>

    <% when "SleepRecord" %>
      <td class="dashboard-col-detail">
        <span class="font-semibold text-gray-600">開始：</span>
        <%= record.start_time&.strftime("%H:%M") %>
        <span class="mx-1">〜</span>
        <span class="font-semibold text-gray-600">終了：</span>
        <%= record.end_time&.strftime("%H:%M") %>
      </td>
      <td class="dashboard-col-detail">
        <span class="font-semibold text-gray-600"> 睡眠合計：</span>
        <% if record.start_time && record.end_time %>
          <% duration_in_seconds = record.end_time - record.start_time %>
          <% hours = (duration_in_seconds / 3600).floor %>
          <% minutes = ((duration_in_seconds % 3600) / 60).round %>
          <%= "#{hours}時間#{minutes}分" %>
        <% else %>
          記録なし
        <% end %>
      </td>
      <td class="dashboard-col-memo">
      <% if record.memo.present? %>
        <span class="font-semibold text-gray-600">メモ：</span>
        <%= truncate(record.memo.to_s, length: 10, omission: "…") %></td>
      <% end %>

    <% when "Temperature" %>
      <td class="dashboard-col-detail"><%= sprintf("%.1f", record.temperature) %>(℃)</td>
      <td class="dashboard-col-detail"></td>
      <td class="dashboard-col-memo">
      <% if record.memo.present? %>
        <span class="font-semibold text-gray-600">メモ：</span>
        <%= truncate(record.memo.to_s, length: 10, omission: "…") %></td>
      <% end %>

    <% when "Bath" %>
      <td class="dashboard-col-detail">
      <span class="font-semibold text-gray-600">種類：</span>
      <%= record.bath_type %></td>
      <td class="dashboard-col-detail"></td>
      <td class="dashboard-col-memo">
      <% if record.memo.present? %>
        <span class="font-semibold text-gray-600">メモ：</span>
        <%= truncate(record.memo.to_s, length: 10, omission: "…") %></td>
      <% end %>

    <% when "Vaccination" %>
      <td class="dashboard-col-detail">
      <span class="font-semibold text-gray-600">種類：</span>
      <%= record.vaccine_name %></td>
      <td class="dashboard-col-detail"></td>
      <td class="dashboard-col-memo">
      <% if record.memo.present? %>
        <span class="font-semibold text-gray-600">メモ：</span>
        <%= truncate(record.memo.to_s, length: 10, omission: "…") %></td>
      <% end %>

    <% else %>
      <td class="dashboard-col-detail" colspan="2"><%= record.respond_to?(:memo) ? truncate(record.memo.to_s, length: 10, omission: "…") : "-" %></td>
      <td class="dashboard-col-memo"></td>
  <% end %>

  <!-- 右端の矢印 -->
  <td class="dashboard-col-chevron text-right pr-2">
    <%= link_to(
      edit_polymorphic_path([current_child, record]),
      data: { turbo_frame: "modal" },
      class: "dashboard-edit-btn"
    ) do %>
      <i class="fa-solid fa-chevron-right"></i>
    <% end %>
  </td>
</tr>