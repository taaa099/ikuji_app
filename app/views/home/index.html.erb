<h1 class="dashboard-title">ダッシュボード</h1>

<%# ----- 成長記録(グラフ) ----- %>
<div class="stats">
  <% if @latest_height && @latest_weight %>
    <p>最新身長: <strong><%= @latest_height %> cm</strong> (<%= @height_diff >= 0 ? "+" : "" %><%= @height_diff %>)</p>
    <p>最新体重: <strong><%= @latest_weight %> kg</strong> (<%= @weight_diff >= 0 ? "+" : "" %><%= @weight_diff %>)</p>
    <p>平均身長: <strong><%= @avg_height %> cm</strong></p>
    <p>平均体重: <strong><%= @avg_weight %> kg</strong></p>
  <% else %>
    <p>成長記録はまだ登録されていません。</p>
  <% end %>
</div>

<canvas id="dashboardChart" data-growths='<%= raw @growths_for_chart.to_json %>'></canvas>

<%# ----- スケジュール一覧（直近5件） ----- %>
<h2 class="dashboard-title">スケジュール（直近）</h2>
<table class="dashboard-table dashboard-schedule-table">
  <thead>
    <tr>
      <th class="dashboard-schedule-col-date">日時</th>
      <th class="dashboard-schedule-col-title">タイトル</th>
      <th class="dashboard-schedule-col-detail">詳細</th>
    </tr>
  </thead>
  <tbody>
    <% @schedules.each do |schedule| %>
      <tr>
        <td class="dashboard-schedule-col-date">
          <%= schedule.start_time.strftime("%m/%d") %>
          <% if schedule.all_day %>
            終日
          <% else %>
            <%= schedule.start_time.strftime(" %H:%M") %>
            <% if schedule.end_time %>
              〜<%= schedule.end_time.strftime("%H:%M") %>
            <% end %>
          <% end %>
        </td>
        <td class="dashboard-schedule-col-title"><%= schedule.title %></td>
        <td class="dashboard-schedule-col-detail"><%= schedule.memo %></td>
      </tr>
    <% end %>
    <% if @schedules.empty? %>
      <tr>
        <td colspan="3">スケジュールはありません</td>
      </tr>
    <% end %>
  </tbody>
</table>

<%# ----- 育児記録一覧 ----- %>
<h2 class="dashboard-title">育児記録一覧</h2>
<table class="dashboard-table">
  <thead>
    <tr>
      <th class="dashboard-col-item">項目</th>
      <th class="dashboard-col-date">日時</th>
      <th class="dashboard-col-detail">詳細1</th>
      <th class="dashboard-col-detail">詳細2</th>
      <th class="dashboard-col-memo">メモ</th>
    </tr>
  </thead>

  <tbody id="dashboard-records">
    <%= render partial: "home/record_row", collection: @records, as: :record %>
  </tbody>
</table>