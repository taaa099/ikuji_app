<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Ikuji App" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "sidebar", "records", "schedule", "dashboard", "growth", "sleep_analysis", "daily", "user_settings/profile", "user_settings/darkmode", "modals", "notification", "tips", "data-turbo-track": "reload" %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module" %>
    <%= javascript_importmap_tags %>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
  </head>
  <body data-current-child-id="<%= @current_child&.id || 0 %>" class="bg-white text-black dark:bg-gray-900 dark:text-gray-100">
    <header class="site-header">
      <% if user_signed_in? %>
        <div class="header-nav">
          <!-- „Çµ„Ç§„Éâ„Éê„Éº„Éú„Çø„É≥ -->
          <button id="sidebar-toggle" class="nav-btn">‚ò∞ „É°„Éã„É•„Éº</button>

          <div id="user-menu">
            <% if current_child.present? %>
              <p>ÁèæÂú®„ÅÆÂ≠ê„Å©„ÇÇ: <%= current_child.name %></p>
            <% else %>
              <p>Â≠ê„Å©„ÇÇ„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</p>
            <% end %>

            <%= form_with(url: switch_child_path, method: :post, local: true, data: {turbo: false}) do %>
              <%= select_tag :id, options_from_collection_for_select(current_user.children, :id, :name, session[:current_child_id]) %>
              <%= submit_tag "Âàá„ÇäÊõø„Åà" %>
            <% end %>

            <nav class="header-nav">
              <%= link_to "„Éà„ÉÉ„Éó„Éö„Éº„Ç∏", root_path, class: "nav-btn" %>
              <%= link_to "Â≠ê„Å©„ÇÇ„ÇíÂàá„ÇäÊõø„Åà„Çã", children_path, class: "nav-btn" %>
              <%= link_to "Â≠ê‰æõ‰∏ÄË¶ß", children_path, class: "nav-btn" %>
              <%= link_to "Â≠ê‰æõ„ÅÆÁôªÈå≤", new_child_path, class: "nav-btn" %>
              <%= link_to "Â≠ê‰æõ„ÅÆÁ∑®ÈõÜ„ÉªÂâäÈô§", children_path, class: "nav-btn" %>
              <%= link_to "„Éë„Éë„Éû„ÉûTips", tips_path, class: "nav-btn" %>

              <% if current_child.present? %>
                <%= link_to "Êéà‰π≥‰∏ÄË¶ß", child_feeds_path(current_child), class: "nav-btn" %>
                <%= link_to "„Åä„ÇÄ„Å§‰∏ÄË¶ß", child_diapers_path(current_child), class: "nav-btn" %>
                <%= link_to "„Åä„ÇÄ„Å§„ÅÆÁôªÈå≤", new_child_diaper_path(current_child), class: "nav-btn" %>
                <%= link_to "„Éü„É´„ÇØ‰∏ÄË¶ß", child_bottles_path(current_child), class: "nav-btn" %>
                <%= link_to "„Éü„É´„ÇØ„ÅÆÁôªÈå≤", new_child_bottle_path(current_child), class: "nav-btn" %>
                <%= link_to "Ê∞¥ÂàÜË£úÁµ¶‰∏ÄË¶ß", child_hydrations_path(current_child), class: "nav-btn" %>
                <%= link_to "Ê∞¥ÂàÜ„ÅÆÁôªÈå≤", new_child_hydration_path(current_child), class: "nav-btn" %>
                <%= link_to "Èõ¢‰π≥È£ü‰∏ÄË¶ß", child_baby_foods_path(current_child), class: "nav-btn" %>
                <%= link_to "Èõ¢‰π≥È£ü„ÅÆÁôªÈå≤", new_child_baby_food_path(current_child), class: "nav-btn" %>
                <%= link_to "Áù°Áú†‰∏ÄË¶ß", child_sleep_records_path(current_child), class: "nav-btn" %>
                <%= link_to "Áù°Áú†„ÅÆÁôªÈå≤", new_child_sleep_record_path(current_child), class: "nav-btn" %>
                <%= link_to "‰ΩìÊ∏©‰∏ÄË¶ß", child_temperatures_path(current_child), class: "nav-btn" %>
                <%= link_to "‰ΩìÊ∏©„ÅÆÁôªÈå≤", new_child_temperature_path(current_child), class: "nav-btn" %>
                <%= link_to "„ÅäÈ¢®ÂëÇ‰∏ÄË¶ß", child_baths_path(current_child), class: "nav-btn" %>
                <%= link_to "„ÅäÈ¢®ÂëÇ„ÅÆÁôªÈå≤", new_child_bath_path(current_child), class: "nav-btn" %>
                <%= link_to "‰∫àÈò≤Êé•Á®Æ‰∏ÄË¶ß", child_vaccinations_path(current_child), class: "nav-btn" %>
                <%= link_to "‰∫àÈò≤Êé•Á®Æ„ÅÆÁôªÈå≤", new_child_vaccination_path(current_child), class: "nav-btn" %>
                <%= link_to "„Çπ„Ç±„Ç∏„É•„Éº„É´‰∏ÄË¶ß", schedules_path(current_child), class: "nav-btn" %>
                <%= link_to "„Çπ„Ç±„Ç∏„É•„Éº„É´„ÅÆÁôªÈå≤", new_schedule_path(current_child), class: "nav-btn" %>
                <%= link_to "ÊàêÈï∑Ë®òÈå≤", child_growths_path(current_child), class: "nav-btn" %>
                <%= link_to "ÊàêÈï∑Ë®òÈå≤„ÅÆÁôªÈå≤", new_child_growth_path(current_child), class: "nav-btn" %>
                <%= link_to "Êó•Ë®ò‰∏ÄË¶ß", diaries_path, class: "nav-btn" %>
                <%= link_to "Êó•Ë®ò„ÇíÊäïÁ®ø", new_diary_path, class: "nav-btn" %>
                <%= link_to "„Éó„É≠„Éï„Ç£„Éº„É´„ÇíË¶ã„Çã", user_path(current_user), class: "nav-btn" %>
                <%= link_to "„Éó„É≠„Éï„Ç£„Éº„É´„ÇíÁ∑®ÈõÜ", edit_user_registration_path(tab: "profile"), class: "nav-btn" %>
                <%= link_to "„Éë„Çπ„ÉØ„Éº„ÉâÂ§âÊõ¥", edit_user_registration_path(tab: "password"), class: "nav-btn" %>
                <button id="dark-mode-toggle" class="p-2 border rounded ml-2">
                  üåô / ‚òÄÔ∏è
                </button>
                <%= link_to notifications_path(current_child), class: "notification-link" do %>
                  <i class="fa fa-bell"></i>
                  <% if current_child.notifications.where(read: false).exists? %>
                    <span class="notification-count">
                      <%= current_child.notifications.where(read: false).count %>
                    </span>
                  <% end %>
                <% end %>
              <% end %>

              <%= link_to '„É≠„Ç∞„Ç¢„Ç¶„Éà', destroy_user_session_path, data: { turbo_method: :delete }, class: "nav-btn" %>
            </nav>
          </div>
        </div>
      <% end %>
    </header>
   
    <!-- „Éï„É©„ÉÉ„Ç∑„É•Ë°®Á§∫Áî® -->
    <div id="flash-messages">
      <%= render "shared/flash" %>
    </div>

    <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    <%= render "layouts/sidebar" %>

    <!-- ÈÄöÂ∏∏„Éö„Éº„Ç∏„ÅÆ„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
    <div class="main-content">
      <%= yield %>
    </div>

    <!-- ÈÄöÁü•Áî®„Ç≥„É≥„ÉÜ„Éä -->
    <div id="notification-container"></div>
  </body>
</html>